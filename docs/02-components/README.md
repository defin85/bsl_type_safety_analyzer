# Компоненты BSL Type Safety Analyzer

Документация по основным компонентам системы.

## 📦 Core Components (Heavy)

### [Unified Index](./unified-index/)
- Единый индекс всех BSL типов
- 24,000+ типов в памяти
- O(1) поиск по имени
- Граф наследования и совместимости

### [MCP Server](./mcp-server/)
- Model Context Protocol сервер
- Интерфейс для LLM (Claude, GPT)
- JSON-RPC протокол
- Доступ к полному контексту

## 🚀 Shell Components (Light)

### [BSL Parser](./bsl-parser/)
- Парсер на базе **tree-sitter** ⚠️
- Инкрементальный парсинг
- Error recovery
- **Внимание**: legacy-design.md описывает устаревший подход (logos+nom)

### [Shell Tools](./shell-tools/)
- CLI утилиты для быстрых проверок
- Минимальный LSP сервер
- Интеграция с VSCode

## 🏗️ Архитектура взаимодействия

```
┌─────────────────────────────────────┐
│           LLM (Claude)              │
└────────────┬───────────────────────┘
             │ MCP Protocol
┌────────────▼───────────────────────┐
│         MCP Server                  │
│    ┌───────────────────┐           │
│    │  UnifiedBslIndex  │           │
│    │   (Core/Heavy)    │           │
│    └───────────────────┘           │
└────────────┬───────────────────────┘
             │ Cache/API
┌────────────▼───────────────────────┐
│      Shell Tools (Light)           │
│  ┌─────────┐  ┌──────────┐        │
│  │   CLI   │  │   LSP    │        │
│  └─────────┘  └──────────┘        │
└────────────────────────────────────┘
```

## 📝 Ключевые решения

1. **Разделение Core/Shell** - тяжелое ядро для LLM, легкие инструменты для людей
2. **Tree-sitter для парсера** - НЕ logos+nom (см. актуальные решения)
3. **UnifiedBslIndex** - единый источник правды о типах
4. **MCP как основной протокол** - для интеграции с AI