# Компоненты BSL Type Safety Analyzer

Документация по основным компонентам системы.

## 📦 Core Components (Heavy)

### [Unified Index](./unified-index/)
- Единый индекс всех BSL типов
- 24,000+ типов в памяти
- O(1) поиск по имени
- Граф наследования и совместимости

### [MCP Server](./mcp-server/)
- Model Context Protocol сервер
- Интерфейс для LLM (Claude, GPT)
- JSON-RPC протокол
- Доступ к полному контексту

## 🚀 Shell Components (Light)

### [BSL Parser](./bsl-parser/)
- Парсер на базе **tree-sitter** ⚠️
- Инкрементальный парсинг
- Error recovery
- **Внимание**: legacy-design.md описывает устаревший подход (logos+nom)

### [Shell Tools](./shell-tools/)
- ✅ **Полноценный LSP сервер** (ГОТОВ - 731 строк) 
- 🚧 CLI утилиты для быстрых проверок (планируется)
- ✅ Интеграция с VSCode

## 🏗️ Архитектура взаимодействия (обновлено v1.8.0)

```
┌─────────────────────────────────────┐
│           LLM (Claude)              │
└────────────┬───────────────────────┘
             │ MCP Protocol
┌────────────▼───────────────────────┐
│         MCP Server                  │  🚧 В разработке
│    ┌───────────────────┐           │
│    │  UnifiedBslIndex  │           │
│    │   (Core/Heavy)    │           │  
│    └───────────────────┘           │
└────────────┬───────────────────────┘
             │ Cache/API
┌────────────▼───────────────────────┐
│    VSCode + LSP (Production)       │  ✅ ГОТОВО  
│  ┌─────────┐  ┌──────────┐        │
│  │Extension│  │LSP Server│        │  731 строк
│  │(Shell)  │  │(Core)    │        │  UnifiedBslIndex
│  └─────────┘  └──────────┘        │  Real-time analysis
└────────────────────────────────────┘
```

**Ключевое изменение v1.8.0:** LSP сервер стал полноценным Core компонентом!

## 📝 Ключевые решения (обновлено v1.8.0)

1. **Разделение Core/Shell** - тяжелое ядро для LLM, легкие инструменты для людей
2. **Tree-sitter для парсера** - НЕ logos+nom (см. актуальные решения)  
3. **UnifiedBslIndex** - единый источник правды о типах
4. **LSP-first подход** ✨ - LSP сервер как полноценный Core компонент
5. **MCP как протокол для LLM** - дополняет LSP для разработчиков